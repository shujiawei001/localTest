#include "setup/settings.txt"

@testing:case="function_tmmin_T_scalar",exception=1
tmmin(1,1,1)

@testing:case="function_tmmin_T_null",exception=1
tmmin(,1,1)

@testing:case="function_tmmin_T_the_first_NULL",exception=1
tmmin([NULL, 3, 4, 5, 5, 6, 6, 7, 7, 9], 1..10, 3)

@testing:case="function_tmmin_T_not_the_first_NULL",exception=1
tmmin([2, 3, 4, NULL, 5, 6, 6, 7, 7, 9], 1..10, 3)

@testing:case="function_tmmin_T_bool_scalar",exception=1
tmmin(true,1,1)

@testing:case="function_tmmin_T_char_scalar",exception=1
tmmin('a',1,3)

@testing:case="function_tmmin_T_short_scalar",exception=1
tmmin(122h, 1,3)

@testing:case="function_tmmin_T_long_scalar",exception=1
tmmin(122l, 1,3)

@testing:case="function_tmmin_T_date_scalar",exception=1
tmmin(2013.06.13, 1,3)

@testing:case="function_tmmin_T_month_scalar",exception=1
tmmin(2012.06M, 1,3)

@testing:case="function_tmmin_T_float_scalar",exception=1
tmmin(12.1f, 1,3)

@testing:case="function_tmmin_T_double_scalar",exception=1
tmmin(2.1, 1,3)

@testing:case="function_tmmin_T_string_scalar",exception=1
tmmin("Hello", 1,3)

@testing:case="function_tmmin_T_uuid_scalar",exception=1
tmmin(uuid("5d212a78-cc48-e3b1-4235-b4d91473ee87"), 1,3)

@testing:case="function_tmmin_T_code_scalar",exception=1
tmmin(<1+2>, 1,3)

@testing:case="function_tmmin_T_any_scalar",exception=1
tmmin((1,2,3), 1,3)

@testing:case="function_tmmin_T_int128_scalar",exception=1
tmmin(int128("e1671797c52e15f763380b45e841ec32"), 1,3)

@testing:case="function_tmmin_T_ipaddr_scalar",exception=1
tmmin(ipaddr("192.168.1.13"), 1,3)

@testing:case="function_tmmin_T_duration_scalar",exception=1
tmmin(duration("1M"), 1,3)

@testing:case="function_tmmin_T_string_vector",exception=1
tmmin(`A`B`C, 1 2 3,3)

@testing:case="function_tmmin_T_double_vector",exception=1
tmmin([1.12, 2.23, 3.3], 1 2 3, 3)

@testing:case="function_tmmin_T_float_vector",exception=1
tmmin([1.12f, 2.23f, 3.3f], 1 2 3, 3)

@testing:case="function_tmmin_T_NULL_vector",exception=1
tmmin([1, NULL, 3], 1 2 3, 3)

@testing:case="function_tmmin_T_not_ascending_vector",exception=1
tmmin([3, 2, 1], 1 2 3, 3)

@testing:case="function_tmmin_T_matrix",exception=1
tmmin(matrix(int, 2, 3), matrix(int, 2, 3), 3)

@testing:case="function_tmmin_T_set",exception=1
tmmin(set([5,5,3,4]),[1, 2, 3], 3)

@testing:case="function_tmmin_T_table",exception=1
tmmin(table(1..10 as qty), 1..10, 3)

@testing:case="function_tmmin_X_scalar",exception=1
tmmin(1..10, 1, 3)

@testing:case="function_tmmin_X_NULL",exception=1
tmmin(1..10, , 3)

@testing:case="function_tmmin_X_string",exception=1
tmmin(1..10, `A + string(1..10), 3)

@testing:case="function_tmmin_X_bool",exception=1
tmmin(1..10, bool(1..10), 3)

@testing:case="function_tmmin_X_date",exception=1
tmmin(1..10, 2013.06.13 + 1..10, 3)

@testing:case="function_tmmin_X_month",exception=1
tmmin(1..10, 2013.06M + 1..10, 3)

@testing:case="function_tmmin_X_code",exception=1
tmmin(1..10,<1+2>, 3)

@testing:case="function_tmmin_X_uuid",exception=1
tmmin(1..10, take(uuid("5d212a78-cc48-e3b1-4235-b4d91473ee87"), 10), 3)

@testing:case="function_tmmin_X_large_than_T",exception=1
tmmin(1..10,1..11, 3)

@testing:case="function_tmmin_X_matrix",exception=1
tmmin(1..10,1..10$2:5, 3)

@testing:case="function_tmmin_window_null",exception=1
tmmin(1..10,1..10, )

@testing:case="function_tmmin_window_negetive",exception=1
tmmin(1..10,1..10, -3)

@testing:case="function_tmmin_window_0",exception=1
tmmin(1..10,1..10, 0)

@testing:case="function_tmmin_window_string",exception=1
tmmin(1..10,1..10, `A)

@testing:case="function_tmmin_window_vector",exception=1
tmmin(1..10,1..10, [1, 0])

@testing:case="function_tmmin_window_pair",exception=1
tmmin(1..10,1..10,3:5)

@testing:case="function_tmmin_window_date",exception=1
tmmin(1..10,1..10,2012.01.01)

@testing:case="function_tmmin_window_bool",exception=1
tmmin(1..10,1..10,true)

@testing:case="function_tmmin_window_double",exception=1
tmmin(1..10,1..10,1.1)

@testing:case="function_tmmin_window_float",exception=1
tmmin(1..10,1..10,10.1)

@testing:case="function_tmmin_window_matrix",exception=1
tmmin(1..10,1..10,1..6$2:3)

@testing:case="function_tmmin_T_inter_duration_3d",exception=1
tmmin(1..10,1..10,3d)

@testing:case="function_tmmin_T_time_negative",exception=1
tmmin(time(-5..4),1..10,3)

@testing:case="function_tmmin_T_integer_vector"
num1=1..10
num2=char(1..10)
num3=long(1..10)
num4=short(1..10)
num5=-5..4
x1=[52,33,74,49,58,46,88,49,38,45]
x2=[52,NULL,74,49,NULL,46,NULL,49,NULL,45]
x3=take(int(), 10)
x4=1.111 20.48 99.99 0.56 -8.33 20.90 -100 -3.33 -55.6 24.5
x5=1.111 NULL 99.99 0.56 NULL 20.90 -100 NULL -55.6 24.5
x6=take(double(), 10)

assert 1, eqObj(tmmin(num1, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 2, eqObj(tmmin(num1, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 3, eqObj(tmmin(num1, x3, 3),take(int(), 10), 3)
assert 4, eqObj(tmmin(num1, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 5, eqObj(tmmin(num1, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 6, eqObj(tmmin(num1, x6, 3),take(double(), 10), 3)

assert 7, eqObj(tmmin(num2, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 8, eqObj(tmmin(num2, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 9, eqObj(tmmin(num2, x3, 3),take(int(), 10), 3)
assert 10, eqObj(tmmin(num2, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 11, eqObj(tmmin(num2, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 12, eqObj(tmmin(num2, x6, 3),take(double(), 10), 3)

assert 13, eqObj(tmmin(num3, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 14, eqObj(tmmin(num3, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 15, eqObj(tmmin(num3, x3, 3),take(int(), 10), 3)
assert 16, eqObj(tmmin(num3, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 17, eqObj(tmmin(num3, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 18, eqObj(tmmin(num3, x6, 3),take(double(), 10), 3)

assert 19, eqObj(tmmin(num4, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 20, eqObj(tmmin(num4, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 21, eqObj(tmmin(num4, x3, 3),take(int(), 10), 3)
assert 22, eqObj(tmmin(num4, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 23, eqObj(tmmin(num4, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 24, eqObj(tmmin(num4, x6, 3),take(double(), 10), 3)

assert 25, eqObj(tmmin(num5, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 26, eqObj(tmmin(num5, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 27, eqObj(tmmin(num5, x3, 3),take(int(), 10), 3)
assert 28, eqObj(tmmin(num5, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 29, eqObj(tmmin(num5, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 30, eqObj(tmmin(num5, x6, 3),take(double(), 10), 3)

@testing:case="function_tmmin_T_temporal_vector"
num1=date(-5..4)
num2=datetime(-5..4)
num3=timestamp(-5..4)
num4=month(-5..4)
num5=time(1..10)
x1=[52,33,74,49,58,46,88,49,38,45]
x2=[52,NULL,74,49,NULL,46,NULL,49,NULL,45]
x3=take(int(), 10)
x4=1.111 20.48 99.99 0.56 -8.33 20.90 -100 -3.33 -55.6 24.5
x5=1.111 NULL 99.99 0.56 NULL 20.90 -100 NULL -55.6 24.5
x6=take(double(), 10)

assert 1, eqObj(tmmin(num1, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 2, eqObj(tmmin(num1, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 3, eqObj(tmmin(num1, x3, 3),take(int(), 10), 3)
assert 4, eqObj(tmmin(num1, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 5, eqObj(tmmin(num1, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 6, eqObj(tmmin(num1, x6, 3),take(double(), 10), 3)

assert 7, eqObj(tmmin(num2, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 8, eqObj(tmmin(num2, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 9, eqObj(tmmin(num2, x3, 3),take(int(), 10), 3)
assert 10, eqObj(tmmin(num2, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 11, eqObj(tmmin(num2, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 12, eqObj(tmmin(num2, x6, 3),take(double(), 10), 3)

assert 13, eqObj(tmmin(num3, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 14, eqObj(tmmin(num3, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 15, eqObj(tmmin(num3, x3, 3),take(int(), 10), 3)
assert 16, eqObj(tmmin(num3, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 17, eqObj(tmmin(num3, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 18, eqObj(tmmin(num3, x6, 3),take(double(), 10), 3)

assert 19, eqObj(tmmin(num4, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 20, eqObj(tmmin(num4, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 21, eqObj(tmmin(num4, x3, 3),take(int(), 10), 3)
assert 22, eqObj(tmmin(num4, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 23, eqObj(tmmin(num4, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 24, eqObj(tmmin(num4, x6, 3),take(double(), 10), 3)

assert 25, eqObj(tmmin(num5, x1, 3),[52,33,33,33,49,46,46,46,38,38])
assert 26, eqObj(tmmin(num5, x2, 3),[52,52,52,49,49,46,46,46,49,45])
assert 27, eqObj(tmmin(num5, x3, 3),take(int(), 10), 3)
assert 28, eqObj(tmmin(num5, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-55.6], 1)
assert 29, eqObj(tmmin(num5, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-55.6], 1)
assert 30, eqObj(tmmin(num5, x6, 3),take(double(), 10), 3)

@testing:case="function_tmmin_T_integer_vector_all_same"
num1=take(1,10)
num2=char(take(1,10))
num3=long(take(1,10))
num4=short(take(1,10))
num5=-5..4
x1=[52,33,74,49,58,46,88,49,38,45]
x2=[52,NULL,74,49,NULL,46,NULL,49,NULL,45]
x3=take(int(), 10)
x4=1.111 20.48 99.99 0.56 -8.33 20.90 -100 -3.33 -55.6 24.5
x5=1.111 NULL 99.99 0.56 NULL 20.90 -100 NULL -55.6 24.5
x6=take(double(), 10)

assert 1, eqObj(tmmin(num1, x1, 1), [52,33,33,33,33,33,33,33,33,33])
assert 2, eqObj(tmmin(num1, x2, 2), [52,52,52,49,49,46,46,46,46,45])
assert 3, eqObj(tmmin(num1, x3, 3), take(int(), 10), 3)
assert 4, eqObj(tmmin(num1, x4, 3), [1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-100], 3)
assert 5, eqObj(tmmin(num1, x5, 3), [1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-100], 3)
assert 6, eqObj(tmmin(num1, x6, 3),take(double(), 10), 3)

assert 7, eqObj(tmmin(num2, x1, 1), [52,33,33,33,33,33,33,33,33,33])
assert 8, eqObj(tmmin(num2, x2, 3), [52,52,52,49,49,46,46,46,46,45])
assert 9, eqObj(tmmin(num2, x3, 3), take(int(), 10), 3)
assert 10, eqObj(tmmin(num2, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-100], 3)
assert 11, eqObj(tmmin(num2, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-100], 3)
assert 12, eqObj(tmmin(num2, x6, 3),take(double(), 10), 3)

assert 13, eqObj(tmmin(num3, x1, 3), [52,33,33,33,33,33,33,33,33,33])
assert 14, eqObj(tmmin(num3, x2, 3), [52,52,52,49,49,46,46,46,46,45])
assert 15, eqObj(tmmin(num3, x3, 3),take(int(), 10), 3)
assert 16, eqObj(tmmin(num3, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-100], 3)
assert 17, eqObj(tmmin(num3, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-100], 3)
assert 18, eqObj(tmmin(num3, x6, 3),take(double(), 10), 3)

assert 19, eqObj(tmmin(num4, x1, 3),[52,33,33,33,33,33,33,33,33,33])
assert 20, eqObj(tmmin(num4, x2, 3),[52,52,52,49,49,46,46,46,46,45])
assert 21, eqObj(tmmin(num4, x3, 3),take(int(), 10), 3)
assert 22, eqObj(tmmin(num4, x4, 3),[1.111,1.111,1.111,0.56,-8.33,-8.33,-100,-100,-100,-100], 3)
assert 23, eqObj(tmmin(num4, x5, 3),[1.111,1.111,1.111,0.56,0.56,0.56,-100,-100,-100,-100], 3)
assert 24, eqObj(tmmin(num4, x6, 3),take(double(), 10), 3)

assert 25, eqObj(tmmin(num5, x1, 2),[52,33,33,49,49,46,46,49,38,38])
assert 26, eqObj(tmmin(num5, x2, 2), [52,52,74,49,49,46,46,49,49,45])
assert 27, eqObj(tmmin(num5, x3, 2),take(int(), 10), 3)
assert 28, eqObj(tmmin(num5, x4, 2),[1.111,1.111,20.48,0.56,-8.33,-8.33,-100,-100,-55.60,-55.60], 3)
assert 29, eqObj(tmmin(num5, x5, 2),[1.111,1.111,99.99,0.56,0.56,20.9,-100,-100,-55.6,-55.6], 3)
assert 30, eqObj(tmmin(num5, x6, 3),take(double(), 10), 3)

@testing:case="function_tmmin_T_integer_vector_different_interval"
num1=[-5, -2, 0, 1, 4, 4, 5, 12, 13, 14]
num2=[-5, -2, 1, 4, 7, 10, 13, 15, 18, 21]
num3=[-5, -3, -1, 1, 3, 5, 7, 9, 11, 13]
num4=[-5, -1, 3, 7, 11, 11, 15, 15, 16, 16]
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,49,49,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,14,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,14,49,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,23,14,14,14,49,49,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,45])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num2, x1, 3), [52,23,74,49,14,46,,49,,45])
assert 8, eqObj(tmmin(num2, x1, 2), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num2, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 10, eqObj(tmmin(num2, x1, 4), [52,23,23,49,14,14,46,49,49,45])
assert 11, eqObj(tmmin(num2, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 12, eqObj(tmmin(num3, x1, 3), [52,23,23,49,14,14,46,49,49,45])
assert 13, eqObj(tmmin(num3, x1, 2), [52,23,74,49,14,46,,49,,45])
assert 14, eqObj(tmmin(num3, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 15, eqObj(tmmin(num3, x1, 4), [52,23,23,49,14,14,46,49,49,45])
assert 16, eqObj(tmmin(num3, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 17, eqObj(tmmin(num4, x1, 3), [52,23,74,49,14,14,,49,49,45])
assert 18, eqObj(tmmin(num4, x1, 2), [52,23,74,49,14,14,,49,49,45])
assert 19, eqObj(tmmin(num4, x1, 1), [52,23,74,49,14,14,,49,,45])
assert 20, eqObj(tmmin(num4, x1, 4), [52,23,74,49,14,14,,49,49,45])
assert 21, eqObj(tmmin(num4, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

@testing:case="function_tmmin_T_timestamp_vector_different_interval"
num1=timestamp([-5, -2, 0, 1, 4, 4, 5, 12, 13, 14])
num2=timestamp([1969.12.19, 1969.12.22, 1969.12.25, 1969.12.31, 1970.01.01, 1970.01.03, 1970.01.06, 1970.01.08, 1970.01.10, 1970.01.11])
num3=1969.11.19T12:34:56.324 1969.12.19T12:34:56.324 1969.12.20T12:34:56.324 1970.01.12T12:24:26.125 1970.01.24T12:24:26.125 1970.01.29T12:24:26.125 1970.01.29T12:24:26.125 1970.02.12T12:24:26.125 1971.02.20T12:24:26.125 1971.02.21T12:24:26.125
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,49,49,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,14,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,14,49,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,23,14,14,14,49,49,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,45])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3ms), [52,23,23,49,14,14,14,49,49,45])
assert 10, eqObj(tmmin(num1, x1, 3m), [52,23,23,23,14,14,14,14,14,14])
assert 11, eqObj(tmmin(num1, x1, 3s), [52,23,23,23,14,14,14,14,14,14])
assert 12, eqObj(tmmin(num1, x1, 3H), [52,23,23,23,14,14,14,14,14,14])

assert 12, eqObj(tmmin(num2, x1, 3d), [52,23,74,49,14,14,,49,49,45])
assert 13, eqObj(tmmin(num2, x1, 2w), [52,23,23,23,14,14,14,14,14,14])
assert 14, eqObj(tmmin(num3, x1, 2M), [52,23,23,23,14,14,14,14,,45])
assert 15, eqObj(tmmin(num3, x1, 1y), [52,23,23,23,14,14,14,14,,45])
assert 16, eqObj(tmmin(num2, x1, 2B), [52,23,74,49,14,46,46,49,,45])

@testing:case="function_tmmin_T_date_vector_different_interval"
num1=date([-5, -2, 0, 1, 4, 4, 5, 12, 13, 14])
num2=date([1969.12.19, 1969.12.22, 1969.12.25, 1969.12.31, 1970.01.01, 1970.01.03, 1970.01.06, 1970.01.08, 1970.01.10, 1970.01.11])
num3=1969.11.19 1969.12.19 1969.12.20 1970.01.12 1970.01.24 1970.01.29 1970.01.29 1970.02.12 1971.02.20 1971.02.21
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,49,49,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,14,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,14,49,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,23,14,14,14,49,49,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,45])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3d), [52,23,23,49,14,14,14,49,49,45])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,74,49,14,46,,49,,45])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,74,49,14,46,,49,,45])

assert 12, eqObj(tmmin(num2, x1, 3d), [52,23,74,49,14,14,,49,49,45])
assert 13, eqObj(tmmin(num2, x1, 2w), [52,23,23,23,14,14,14,14,14,14])
assert 14, eqObj(tmmin(num3, x1, 2M), [52,23,23,23,14,14,14,14,,45])
assert 15, eqObj(tmmin(num3, x1, 1y), [52,23,23,23,14,14,14,14,NULL,45])
assert 16, eqObj(tmmin(num2, x1, 2B), [52,23,74,49,14,46,46,49,,45])

@testing:case="function_tmmin_T_datetime_vector_different_interval"
num1=datetime([-5, -2, 0, 1, 4, 4, 5, 12, 13, 14])
num2=datetime([1969.12.19, 1969.12.22, 1969.12.25, 1969.12.31, 1970.01.01, 1970.01.03, 1970.01.06, 1970.01.08, 1970.01.10, 1970.01.11])
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,49,49,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,14,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,14,49,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,23,14,14,14,49,49,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,45])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3d), [52,23,23,23,14,14,14,14,14,14])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,23,23,14,14,14,14,14,14])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,23,23,14,14,14,14,14,14])

assert 12, eqObj(tmmin(num2, x1, 3d), [52,23,74,49,14,14,,49,49,45])
assert 13, eqObj(tmmin(num2, x1, 2w), [52,23,23,23,14,14,14,14,14,14])
assert 14, eqObj(tmmin(num3, x1, 2M), [52,23,23,23,14,14,14,14,,45])
assert 15, eqObj(tmmin(num3, x1, 1y), [52,23,23,23,14,14,14,14,,45])
assert 16, eqObj(tmmin(num2, x1, 2B), [52,23,74,49,14,46,46,49,,45])

@testing:case="function_tmmin_T_time_vector_different_interval"
num1=time([1, 1, 3, 9, 9, 10, 11, 11, 12, 14])
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,14,46,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,46,46,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,49,14,14,14,14,14,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,14])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3d), [52,23,23,23,14,14,14,14,14,14])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,23,23,14,14,14,14,14,14])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,23,23,14,14,14,14,14,14])

assert 12, eqObj(tmmin(num2, x1, 3d), [52,23,74,49,14,14,,49,49,45])
assert 13, eqObj(tmmin(num2, x1, 2w), [52,23,23,23,14,14,14,14,14,14])
assert 14, eqObj(tmmin(num2, x1, 1M), [52,23,23,23,14,46,,49,,45])
assert 15, eqObj(tmmin(num2, x1, 1y), [52,23,23,23,14,14,14,14,14,14])
assert 16, eqObj(tmmin(num2, x1, 2B), [52,23,74,49,14,46,46,49,,45])

@testing:case="function_tmmin_T_month_vector_different_interval"
num1=month([1, 1, 3, 9, 9, 10, 11, 11, 12, 14])
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,14,46,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,46,46,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,49,14,14,14,14,14,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,14])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3d), [52,23,74,49,14,46,,49,,45])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,74,49,14,46,,49,,45])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,74,49,14,46,,49,,45])

assert 12, eqObj(tmmin(num2, x1, 3d), [52,23,74,49,14,14,,49,49,45])
assert 13, eqObj(tmmin(num2, x1, 2w), [52,23,23,23,14,14,14,14,14,14])
assert 14, eqObj(tmmin(num2, x1, 1M), [52,23,23,23,14,46,,49,,45])
assert 15, eqObj(tmmin(num2, x1, 1y), [52,23,23,23,14,14,14,14,14,14])
assert 16, eqObj(tmmin(num2, x1, 2B), [52,23,74,49,14,46,46,49,,45])

@testing:case="function_tmmin_T_minute_vector_different_interval"
num1=minute([1, 1, 3, 9, 9, 10, 11, 11, 12, 14])
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,14,46,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,46,46,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,49,14,14,14,14,14,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,14])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3ms), [52,23,74,49,14,46,,49,,45])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,74,49,14,46,,49,,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,23,23,14,14,14,14,14,14])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,74,49,14,46,,49,,45])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,23,49,14,14,14,14,46,45])

@testing:case="function_tmmin_T_nanotime_vector_different_interval"
num1=nanotime([1, 1, 3, 9, 9, 10, 11, 11, 12, 14])
x1=[52,23,74,49,14,46,NULL,49,NULL,45]

assert 1, eqObj(tmmin(num1, x1, 3), [52,23,23,49,14,14,14,14,46,45])
assert 2, eqObj(tmmin(num1, x1, 1), [52,23,74,49,14,46,,49,,45])
assert 3, eqObj(tmmin(num1, x1, 2), [52,23,74,49,14,14,46,46,49,45])
assert 4, eqObj(tmmin(num1, x1, 4), [52,23,23,49,14,14,14,14,14,45])
assert 5, eqObj(tmmin(num1, x1,10), [52,23,23,23,14,14,14,14,14,14])
assert 6, eqObj(tmmin(num1, x1, 1024), [52,23,23,23,14,14,14,14,14,14])

assert 7, eqObj(tmmin(num1, x1, 3ms), [52,23,23,23,14,14,14,14,14,14])
assert 8, eqObj(tmmin(num1, x1, 3ns), [52,23,23,49,14,14,14,14,46,45])
assert 9, eqObj(tmmin(num1, x1, 3H), [52,23,23,23,14,14,14,14,14,14])
assert 10, eqObj(tmmin(num1, x1, 3us), [52,23,23,23,14,14,14,14,14,14])
assert 11, eqObj(tmmin(num1, x1, 3m), [52,23,23,23,14,14,14,14,14,14])

@testing:case="function_tmmin_vector_all_NULL_1024"
def f1(datatype1,datatype2) {
	x = take(int(), 1024)
	return tmmin(datatype1(1..1024),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_vector_all_NULL_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	return tmmin(datatype1(1..1048576),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	return tmmin(datatype1(rand(100,1048576).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_vector_all_NULL_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	return tmmin(datatype1(1..3000000),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	return tmmin(datatype1(rand(100,3000000).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_NULL_1024"
def f1(datatype1,datatype2) {
	x = take(int(), 1024)
	x = subarray(x,0:1024)
	return tmmin(datatype1(1..1024),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_NULL_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	x = subarray(x,0:1048576)
	return tmmin(datatype1(1..1048576),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	x = subarray(x,0:1048576)
	return tmmin(datatype1(rand(100,1048576).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_NULL_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	x = subarray(x,0:3000000)
	return tmmin(datatype1(1..3000000),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	x = subarray(x,0:3000000)
	return tmmin(datatype1(rand(100,3000000).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_bigarray_all_NULL_1024"
def f1(datatype1,datatype2) {
	n = 2000000
	x = take(int(), 1024)
	x = bigarray(int,0,n*10).append!(x)
	return tmmin(datatype1(1..1024),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_bigarray_all_NULL_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	n = 2000000
	x = bigarray(int,0,n*10).append!(x)
	return tmmin(datatype1(1..1048576),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	n = 2000000
	x = bigarray(int,0,n*10).append!(x)
	return tmmin(datatype1(rand(100,1048576).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_NULL_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	n = 3000000
	x = bigarray(int,0,n*10).append!(x)
	return tmmin(datatype1(1..3000000),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	n = 3000000
	x = bigarray(int,0,n*10).append!(x)
	return tmmin(datatype1(rand(100,3000000).sort()),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_vector_all_same_1024"
def f1(datatype1,datatype2) {
	x = take(int(), 1024)
	T = take(1,1024)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_vector_all_same_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_vector_all_same_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_same_1024"
def f1(datatype1,datatype2) {
	x = take(int(), 1024)
	x = subarray(x,0:1024)
	T = take(1,1024)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_same_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	x = subarray(x,0:1048576)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	x = subarray(x,0:1048576)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_same_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	x = subarray(x,0:3000000)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	x = subarray(x,0:3000000)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_bigarray_all_same_1024"
def f1(datatype1,datatype2) {
	n = 2000000
	x = take(int(), 1024)
	x = bigarray(int,0,n*10).append!(x)
	T = take(1,1024)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, short, long, date, time, second, minute, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

@testing:case="function_tmmin_bigarray_all_same_2^20"
def f1(datatype1,datatype2) {
	x = take(int(), 1048576)
	n = 2000000
	x = bigarray(int,0,n*10).append!(x)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 1048576)
	n = 2000000
	x = bigarray(int,0,n*10).append!(x)
	T = take(1,1048576)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_subarray_all_same_3000000"
def f1(datatype1,datatype2) {
	x = take(int(), 3000000)
	n = 3000000
	x = bigarray(int,0,n*10).append!(x)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 1, cross(f1,[int, long, date, time, timestamp, nanotimestamp, nanotime, datetime, datehour, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	x = take(int(), 3000000)
	n = 3000000
	x = bigarray(int,0,n*10).append!(x)
	T = take(1,3000000)
	return tmmin(datatype1(T),datatype2(x), 3)==NULL
}
assert 2, cross(f2,[short, second, minute],[char, int, short, long, float, double])

@testing:case="function_tmmin_all_datatypes"
def f1(datatype1,datatype2) {
	T=1..10
	x=7 10 2 6 11 25 69 80 17 12
	re=tmmin(datatype1(T), datatype2(x), 3)
	expected=datatype2([7,7,2,2,2,6,11,25,17,12])
	return eqObj(re,expected,4)
}
assert 1, cross(f1,[int, short, long, date, datehour, timestamp, minute, second, nanotimestamp, nanotime, time, month],[char, int, short, long, float, double])

def f2(datatype1,datatype2) {
	T=1..10
	x=7 NULL 2 6 11 NULL 69 80 17 12
	re=tmmin(datatype1(T), datatype2(x), 3)
	expected=datatype2([7,7,2,2,2,6,11,69,17,12])
	return eqObj(re,expected,4)
}
assert 2, cross(f2,[int, short, long, date, datehour, timestamp, minute, second, nanotimestamp, nanotime, time, month],[char, int, short, long, float, double])

def f3(datatype1,datatype2) {
	T=1..10
	x=take(double(),10)
	re=tmmin(datatype1(T), datatype2(x), 3)
	expected=datatype2(take(double(),10))
	return eqObj(re,expected,4)
}
assert 3, cross(f3,[int, short, long, date, datehour, timestamp, minute, second, nanotimestamp, nanotime, time, month],[char, int, short, long, float, double])

def f4(datatype1,datatype2) {
	T=[-5, -2, -1, 0, 1, 10, 10, 11, 15, 17]
	x=7 10 2 6 11 25 69 80 17 12
	re=tmmin(datatype1(T), datatype2(x), 3)
	expected=datatype2([7,10,10,10,11,25,69,80,17,17])
	return eqObj(re,expected,4)
}
assert 4, cross(f4,[int, short, long, date, datehour, timestamp, nanotimestamp, month],[char, int, short, long, float, double])

def f5(datatype1,datatype2) {
	T=[-5, -2, -1, 0, 1, 10, 10, 11, 15, 17]
	x=7 10 2 6 11 25 69 80 17 12
	re=tmmin(datatype1(T), datatype2(x), 2)
	expected=datatype2([7,10,2,2,6,25,25,25,17,12])
	return eqObj(re,expected,4)
}
assert 5, cross(f5,[int, short, long, date, datehour, timestamp, nanotimestamp, month],[char, int, short, long, float, double])

def f6(datatype1,datatype2) {
	T=[-5, -2, -1, 0, 1, 10, 10, 11, 15, 17]
	x=7 10 2 6 11 25 69 80 17 12
	re=tmmin(datatype1(T), datatype2(x), 1024)
	expected=datatype2([7,7,2,2,2,2,2,2,2,2])
	return eqObj(re,expected,4)
}
assert 6, cross(f6,[int, short, long, date, datehour, timestamp, nanotimestamp, month],[char, int, short, long, float, double])


@testing:case="function_tmmin_array_random_T_1028"
def checktmmin(T, num, siz, window){
	expected=array(int, 0)
	for (i in 0..(siz-1)){
		arr=array(int, 0)
		for(j in i..0){
			if(T[i] - T[j] < window){
				arr.append!(num[j])
			}
		}
		expected.append!(min(arr))
	}
	return expected
}

T=rand(1024, 1028).sort()
num=take([98,24,96,66,26,87,98,75,63,49],1028)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

@testing:case="function_tmmin_array_random_T_timstamp_1024"
T=rand(1969.12.31T23:59:57.123 +1..200000, 1024).sort()
num=take([98,24,96,66,26,87,100,75,63,49],1024)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

@testing:case="function_tmmin_array_random_T_date_1024"
T=rand(1969.01.01+1..200000, 1024).sort()
num=take([98,24,96,66,26,87,100,75,63,49],1024)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

@testing:case="function_tmmin_subarray_random_T_1028"
T=rand(1024, 1028).sort()
T=subarray(T,0:1028)
num=take([98,24,96,66,26,87,100,75,63,49],1028)
num=subarray(num,0:1028)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

@testing:case="function_tmmin_subarray_random_T_timstamp_1024"
T=rand(1969.12.31T23:59:57.123 +1..200000, 1024).sort()
T=subarray(T,0:1024)
num=take([98,24,96,66,26,87,100,75,63,49],1024)
num=subarray(num,0:1024)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

@testing:case="function_tmmin_subarray_random_T_date_1024"
T=rand(1969.01.01+1..200000, 1024).sort()
T=subarray(T,0:1024)
num=take([98,24,96,66,26,87,100,75,63,49],1024)
num=subarray(num,0:1024)
siz=size(T)
window=3
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 1, eqObj(re, ex, 3)

window=1024
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 2, eqObj(re, ex, 3)

window=1023
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 3, eqObj(re, ex, 3)

window=1
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 4, eqObj(re, ex, 3)

window=1025
ex=checktmmin(T, num, siz, window)
re=tmmin(T, num, window)
assert 5, eqObj(re, ex, 3)

/*
@testing:case="function_tmmin_T_1048576"
arr=array(int,0)
for (i in 1..1048576){
	if(i % 2 == 0){
		arr.append!(i)
	}
}
T=take(arr, 1048576).sort()
num=take([98,24,96,66,26,87,98,75,63,49],1048576)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 1048566)
assert 1, eqObj(tmmin(T, num, 3), ex)

T=take(arr, 1048576).sort()
T=subarray(T,0:1048576)
num=take([98,24,96,66,26,87,98,75,63,49],1048576)
num=subarray(num,0:1048576)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 1048566)
assert 2, eqObj(tmmin(T, num, 3), ex, 2)

T=take(arr, 1048576).sort()
T=bigarray(int,0,n*10).append!(T)
num=take([98,24,96,66,26,87,98,75,63,49],1048576)
num=bigarray(int,0,n*10).append!(num)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 1048566)
assert 3, eqObj(tmmin(T, num, 3), ex, 2)

@testing:case="function_tmmin_T_3000000"
arr=array(int,0)
for (i in 1..3000000){
	if(i % 2 == 0){
		arr.append!(i)
	}
}
T=take(arr, 3000000).sort()
num=take([98,24,96,66,26,87,98,75,63,49],3000000)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 2999990)
assert 1, eqObj(tmmin(T, num, 3), ex, 2)

T=take(arr, 3000000).sort()
T=subarray(T,0:3000000)
num=take([98,24,96,66,26,87,98,75,63,49],3000000)
num=subarray(num,0:3000000)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 2999990)
assert 2, eqObj(tmmin(T, num, 3), ex, 2)

T=take(arr, 3000000).sort()
T=bigarray(int,0,n*10).append!(T)
num=take([98,24,96,66,26,87,98,75,63,49],3000000)
num=bigarray(int,0,n*10).append!(num)
ex=[98, 24, 24, 24, 26, 26, 26, 26, 63, 49] join take([49, 24, 24, 24, 26, 26, 26, 26, 63, 49], 2999990)
assert 3, eqObj(tmmin(T, num, 3), ex, 2)
*/

@testing:case="function_tmmin_table_prepare_value_small_data"
dbName = "dfs://test_tmmin"
if(existsDatabase(dbName)){
	dropDatabase(dbName)
}
t = table(1:0, [`symbol, `name, `ID, `price1, `price2, `timestamp, `date], [SYMBOL, STRING, INT, FLOAT, DOUBLE, TIMESTAMP, DATE])
db = database(directory=dbName, partitionType=VALUE, partitionScheme=2020.01.01..2020.02.20)
pt = db.createPartitionedTable(table=t, tableName=`pt, partitionColumns=`timestamp)
dt = db.createTable(table=t, tableName=`dt)

n = 1000
exTable = table(n:0, [`symbol, `name, `ID, `price1, `price2, `timestamp, `date], [SYMBOL, STRING, INT, FLOAT, DOUBLE, TIMESTAMP, DATE])
dataTable = table(take(`A`B`C`D`E, n) as symbol, rand("name" + string(1..10), n) as name, rand(1..n, n) as id, rand(rand(100.0f,1000) join take(float(),100),n) as price1, rand(rand(100.0,1000) join take(double(),100),n) as price2, take(temporalAdd(2020.01.01T12:23:24.345, (1..n), `h), n) as timestamp, take(2020.01.01 + 1..50, n).sort() as date)

exTable.append!(dataTable)
pt.append!(dataTable)
dt.append!(dataTable)

@testing:case="function_tmmin_dfs_table"
re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3H) from ex
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3d) from ex
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3s) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3s) from ex
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3y) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3y) from ex
assert 4, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3M) from ex
assert 5, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3m) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3m) from ex
assert 6, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2B) from ex
assert 7, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2ms) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2ms) from ex
assert 8, eqObj(re.values(), ex.values(), 3)

re=select tmmin(date, ID, 3d) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(date, ID, 3d) from ex
assert 9, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dt_table"
re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3H) from ex
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3d) from ex
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3s) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3s) from ex
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3y) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3y) from ex
assert 4, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3M) from ex
assert 5, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3m) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3m) from ex
assert 6, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2B) from ex
assert 7, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2ms) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2ms) from ex
assert 8, eqObj(re.values(), ex.values(), 3)

re=select tmmin(date, ID, 3d) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(date, ID, 3d) from ex
assert 9, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dfs_table_context_by"
re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3d) as tmmin from ex context by symbol
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2B) as tmmin from ex context by symbol
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3H) as tmmin from ex context by symbol
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3M) as tmmin from ex context by symbol
assert 4, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dt_table_context_by"
re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3d) as tmmin from ex context by symbol
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2B) as tmmin from ex context by symbol
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3H) as tmmin from ex context by symbol
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3M) as tmmin from ex context by symbol
assert 4, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_table_prepare_value_bigdata_data"
dbName = "dfs://test_tmmin_big_data"
if(existsDatabase(dbName)){
	dropDatabase(dbName)
}
t = table(1:0, [`symbol, `name, `ID, `price1, `price2, `timestamp, `date], [SYMBOL, STRING, INT, FLOAT, DOUBLE, TIMESTAMP, DATE])
db = database(directory=dbName, partitionType=VALUE, partitionScheme=2020.01.01..2020.02.20)
pt = db.createPartitionedTable(table=t, tableName=`pt, partitionColumns=`timestamp)
dt = db.createTable(table=t, tableName=`dt)

n = 1048580
exTable = table(n:0, [`symbol, `name, `ID, `price1, `price2, `timestamp, `date], [SYMBOL, STRING, INT, FLOAT, DOUBLE, TIMESTAMP, DATE])
dataTable = table(take(`A`B`C`D`E, n) as symbol, rand("name" + string(1..10), n) as name, rand(1..n, n) as id, rand(rand(100.0f,1000) join take(float(),100),n) as price1, rand(rand(100.0,1000) join take(double(),100),n) as price2, take(temporalAdd(2020.01.01T12:23:24.345, (1..1000), `h), n).sort() as timestamp, take(2020.01.01 + 1..50, n).sort() as date)

exTable.append!(dataTable)
pt.append!(dataTable)
dt.append!(dataTable)

@testing:case="function_tmmin_dfs_table_bigdata"
re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3H) from ex
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3d) from ex
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3s) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3s) from ex
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3y) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3y) from ex
assert 4, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3M) from ex
assert 5, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3m) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3m) from ex
assert 6, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2B) from ex
assert 7, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2ms) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2ms) from ex
assert 8, eqObj(re.values(), ex.values(), 3)

re=select tmmin(date, ID, 3d) as tmmin from loadTable(dbName, `pt)
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(date, ID, 3d) from ex
assert 9, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dt_table_bigdata"
re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3H) from ex
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3d) from ex
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3s) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3s) from ex
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3y) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3y) from ex
assert 4, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3M) from ex
assert 5, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3m) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3m) from ex
assert 6, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2B) from ex
assert 7, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2ms) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2ms) from ex
assert 8, eqObj(re.values(), ex.values(), 3)

re=select tmmin(date, ID, 3d) as tmmin from loadTable(dbName, `dt)
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(date, ID, 3d) from ex
assert 9, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dfs_table_context_by_bigdata"
re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3d) as tmmin from ex context by symbol
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 2B) as tmmin from ex context by symbol
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3H) as tmmin from ex context by symbol
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `pt) context by symbol
ex=select * from loadTable(dbName, `pt)
ex=select tmmin(timestamp, ID, 3M) as tmmin from ex context by symbol
assert 4, eqObj(re.values(), ex.values(), 3)

@testing:case="function_tmmin_dt_table_context_by_bigdata"
re=select tmmin(timestamp, ID, 3d) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3d) as tmmin from ex context by symbol
assert 1, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 2B) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 2B) as tmmin from ex context by symbol
assert 2, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3H) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3H) as tmmin from ex context by symbol
assert 3, eqObj(re.values(), ex.values(), 3)

re=select tmmin(timestamp, ID, 3M) as tmmin from loadTable(dbName, `dt) context by symbol
ex=select * from loadTable(dbName, `dt)
ex=select tmmin(timestamp, ID, 3M) as tmmin from ex context by symbol
assert 4, eqObj(re.values(), ex.values(), 3)
/***
@testing:case="function_tmmin_compare_with_python"
t=loadText(DATA_DIR+ "USPrices_FIRST.csv")
ex=loadText(DATA_DIR+ "TMMIN.csv")
re=select tmmin(date, VOL, 10) as tmmin from t 
ex=select VOL from ex
assert 1, eqObj(re.values(), ex.values(), 3)



